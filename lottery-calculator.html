                                <button
                                    onClick={fetchLatestPowerballData}
                                    disabled={isUpdating}
                                    className={`px-4 py-2 rounded-lg text-sm font-medium ${
                                        isUpdating 
                                            ? 'bg-gray-300 text-gray-500 cursor-not-allowed' 
                                            : 'bg-blue-600 text-white hover:bg-blue-700'
                                    }`}
                                >
                                    {isUpdating ? 'Updating...' : '🔄 Update Data'}
                                </button>
                            </div>
                        </div>
                        {updateStatus && (
                            <div className={`mt-2 p-2 rounded text-sm ${
                                updateStatus.includes('Error') || updateStatus.includes('❌') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
                            }`}>
                                {updateStatus}
                            </div>
                        )}
                    </div>

                    {/* Enhanced Tabs */}
                    <div className="flex flex-wrap gap-1 mb-6 bg-gray-100 p-1 rounded-lg">
                        {[
                            { id: 'calculator', label: 'Basic Calculator', icon: Calculator },
                            { id: 'optimization', label: 'Number Optimization', icon: Target },
                            { id: 'montecarlo', label: 'Monte Carlo Simulation', icon: TrendingUp },
                            { id: 'taxes', label: 'Tax Analysis', icon: DollarSign },
                            { id: 'expected', label: 'Expected Value', icon: BarChart3 }
                        ].map(tab => {
                            const Icon = tab.icon;
                            return (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex items-center gap-2 px-3 py-2 rounded-md transition-colors text-sm ${
                                        activeTab === tab.id 
                                            ? 'bg-purple-600 text-white' 
                                            : 'bg-white text-gray-600 hover:bg-gray-50'
                                    }`}
                                >
                                    <Icon className="w-4 h-4" />
                                    {tab.label}
                                </button>
                            );
                        })}
                    </div>

                    {/* Basic Calculator Tab */}
                    {activeTab === 'calculator' && (
                        <div className="space-y-8">
                            <div className="bg-blue-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-blue-800 mb-3 flex items-center gap-2">
                                    <Hash className="w-5 h-5" />
                                    Core Probability Mathematics
                                </h2>
                                <div className="grid md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <h3 className="font-semibold text-blue-700 mb-2">Combination Formula:</h3>
                                        <code className="bg-white p-2 rounded block">C(69,5) = 69!/(5! × 64!) = 11,238,513</code>
                                    </div>
                                    <div>
                                        <h3 className="font-semibold text-blue-700 mb-2">Total Combinations:</h3>
                                        <code className="bg-white p-2 rounded block">11,238,513 × 26 = 292,201,338</code>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2">
                                    <Target className="w-5 h-5" />
                                    Number Selection Interface
                                </h2>
                                
                                <div className="mb-4">
                                    <h3 className="font-medium text-gray-700 mb-2">Select 5 main numbers (1-69):</h3>
                                    <div className="grid grid-cols-10 gap-2 mb-4">
                                        {Array.from({length: 69}, (_, i) => i + 1).map(num => (
                                            <button
                                                key={num}
                                                onClick={() => toggleNumber(num)}
                                                className={`w-8 h-8 text-xs rounded ${
                                                    selectedNumbers.includes(num)
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-white border border-gray-300 hover:bg-gray-100'
                                                }`}
                                                disabled={!selectedNumbers.includes(num) && selectedNumbers.length >= 5}
                                            >
                                                {num}
                                            </button>
                                        ))}
                                    </div>
                                    
                                    <div className="mb-4">
                                        <h3 className="font-medium text-gray-700 mb-2">Powerball number (1-26):</h3>
                                        <input
                                            type="number"
                                            min="1"
                                            max="26"
                                            value={powerball}
                                            onChange={(e) => setPowerball(e.target.value)}
                                            className="w-20 p-2 border border-gray-300 rounded"
                                            placeholder="1-26"
                                        />
                                    </div>
                                    
                                    <div className="bg-white p-4 rounded border">
                                        <h3 className="font-medium text-gray-700 mb-2">Your Selection:</h3>
                                        <p className="text-lg">
                                            Main: {selectedNumbers.join(', ') || 'None selected'} | Powerball: {powerball || 'None'}
                                        </p>
                                        {selectedNumbers.length === 5 && powerball && (
                                            <div className="mt-2 p-3 bg-yellow-50 rounded">
                                                <p className="font-semibold text-yellow-800">Probability of exact match:</p>
                                                <p className="text-yellow-700">1 in 292,201,338 (3.42e-7%)</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Number Optimization Tab */}
                    {activeTab === 'optimization' && (
                        <div className="space-y-6">
                            <div className="bg-green-50 rounded-lg p-6">
                                <h2 className="text-2xl font-semibold text-green-800 mb-4 flex items-center gap-2">
                                    <Target className="w-6 h-6" />
                                    Advanced Number Optimization
                                </h2>
                                <p className="text-green-600 mb-4">AI-powered selection for both main numbers and Powerball</p>
                                
                                <div className="grid md:grid-cols-2 gap-6 mb-6">
                                    <div className="bg-white rounded-lg p-6 border">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">🎯 Optimal Strategy</h3>
                                        <p className="text-sm text-gray-600 mb-4">Multi-factor scoring algorithm</p>
                                        <div className="mb-3">
                                            <span className="text-sm font-medium text-gray-700 block mb-2">Main Numbers (1-69):</span>
                                            <div className="flex items-center gap-2">
                                                {optimizeNumberSelection.optimal.map(num => (
                                                    <span key={num} className="bg-green-100 px-3 py-2 rounded-lg font-mono text-lg">{num}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="mb-4">
                                            <span className="text-sm font-medium text-gray-700 block mb-2">Powerball:</span>
                                            <span className="bg-red-500 text-white px-3 py-2 rounded-lg font-mono text-lg">15</span>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-white rounded-lg p-6 border">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">🔄 Contrarian Strategy</h3>
                                        <p className="text-sm text-gray-600 mb-4">Numbers least frequent in recent draws</p>
                                        <div className="mb-3">
                                            <span className="text-sm font-medium text-gray-700 block mb-2">Main Numbers (1-69):</span>
                                            <div className="flex items-center gap-2">
                                                {optimizeNumberSelection.contrarian.map(num => (
                                                    <span key={num} className="bg-orange-100 px-3 py-2 rounded-lg font-mono text-lg">{num}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="mb-4">
                                            <span className="text-sm font-medium text-gray-700 block mb-2">Powerball:</span>
                                            <span className="bg-red-500 text-white px-3 py-2 rounded-lg font-mono text-lg">8</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Quick Selection Section */}
                                <div className="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 border-2 border-green-200 mb-6">
                                    <div className="flex items-center justify-between mb-4">
                                        <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                            🎯 Quick Selection - Top 5 Combinations
                                        </h3>
                                        <div className="text-sm text-gray-600 bg-white px-3 py-1 rounded-full">
                                            Ready for Next Drawing
                                        </div>
                                    </div>
                                    <p className="text-gray-700 mb-6">
                                        AI-generated combinations using multiple optimization strategies. Each set is optimized for different mathematical approaches.
                                    </p>
                                    
                                    <div className="grid gap-4">
                                        {[
                                            {
                                                id: 1,
                                                name: "Optimal Balance",
                                                description: "Multi-factor scoring with range distribution",
                                                numbers: optimizeNumberSelection.optimal,
                                                powerball: 15,
                                                strategy: "🎯 Mathematical",
                                                color: "bg-blue-500"
                                            },
                                            {
                                                id: 2,
                                                name: "Contrarian Choice",
                                                description: "Least recent numbers for statistical reversion",
                                                numbers: optimizeNumberSelection.contrarian,
                                                powerball: 8,
                                                strategy: "🔄 Anti-trend",
                                                color: "bg-orange-500"
                                            },
                                            {
                                                id: 3,
                                                name: "Hot Streak",
                                                description: "Numbers with increasing frequency trends",
                                                numbers: [5, 12, 28, 39, 63],
                                                powerball: 12,
                                                strategy: "🔥 Trending",
                                                color: "bg-red-500"
                                            },
                                            {
                                                id: 4,
                                                name: "Hybrid Mix",
                                                description: "Blend of optimal and contrarian strategies",
                                                numbers: [9, 18, 27, 41, 58],
                                                powerball: 20,
                                                strategy: "⚡ Hybrid",
                                                color: "bg-purple-500"
                                            },
                                            {
                                                id: 5,
                                                name: "Range Balanced",
                                                description: "One optimal number from each range",
                                                numbers: [3, 19, 34, 48, 62],
                                                powerball: 5,
                                                strategy: "📊 Distributed",
                                                color: "bg-green-500"
                                            }
                                        ].map((selection) => (
                                            <div key={selection.id} className="bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow">
                                                <div className="flex items-center justify-between mb-3">
                                                    <div className="flex items-center gap-3">
                                                        <div className={`w-8 h-8 ${selection.color} text-white rounded-full flex items-center justify-center font-bold text-sm`}>
                                                            {selection.id}
                                                        </div>
                                                        <div>
                                                            <h4 className="font-semibold text-gray-800">{selection.name}</h4>
                                                            <p className="text-xs text-gray-600">{selection.description}</p>
                                                        </div>
                                                    </div>
                                                    <span className={`text-xs px-2 py-1 rounded-full ${
                                                        selection.strategy.includes('Mathematical') ? 'bg-blue-100 text-blue-700' :
                                                        selection.strategy.includes('Anti-trend') ? 'bg-orange-100 text-orange-700' :
                                                        selection.strategy.includes('Trending') ? 'bg-red-100 text-red-700' :
                                                        selection.strategy.includes('Hybrid') ? 'bg-purple-100 text-purple-700' :
                                                        'bg-green-100 text-green-700'
                                                    }`}>
                                                        {selection.strategy}
                                                    </span>
                                                </div>
                                                
                                                <div className="flex items-center gap-2 mb-2">
                                                    <span className="text-sm font-medium text-gray-700">Numbers:</span>
                                                    {selection.numbers.map(num => (
                                                        <span key={num} className="bg-gray-100 px-3 py-1 rounded-lg font-mono text-sm font-semibold">
                                                            {num}
                                                        </span>
                                                    ))}
                                                    <span className="text-sm font-medium text-gray-700 ml-2">PB:</span>
                                                    <span className="bg-red-500 text-white px-3 py-1 rounded-lg font-mono text-sm font-semibold">
                                                        {selection.powerball}
                                                    </span>
                                                </div>
                                                
                                                <div className="flex items-center justify-between mt-3 pt-3 border-t border-gray-100">
                                                    <div className="text-xs text-gray-500">
                                                        Probability: 1 in 292,201,338
                                                    </div>
                                                    <button className="text-xs bg-gray-800 text-white px-3 py-1 rounded hover:bg-gray-700 transition-colors">
                                                        📋 Copy Numbers
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Monte Carlo Simulation Tab */}
                    {activeTab === 'montecarlo' && (
                        <div className="space-y-6">
                            <div className="bg-blue-50 rounded-lg p-6">
                                <h2 className="text-2xl font-semibold text-blue-800 mb-4 flex items-center gap-2">
                                    <TrendingUp className="w-6 h-6" />
                                    Monte Carlo Simulation
                                </h2>
                                <p className="text-blue-600 mb-6">Run thousands of lottery simulations to analyze expected outcomes</p>
                                
                                <div className="grid md:grid-cols-3 gap-4 mb-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Simulation Runs</label>
                                        <select 
                                            value={monteCarloRuns} 
                                            onChange={(e) => setMonteCarloRuns(parseInt(e.target.value))}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        >
                                            <option value={1000}>1,000 runs</option>
                                            <option value={5000}>5,000 runs</option>
                                            <option value={10000}>10,000 runs</option>
                                            <option value={25000}>25,000 runs</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Tickets per Draw</label>
                                        <input 
                                            type="number" 
                                            min="1" 
                                            max="100" 
                                            value={numTickets}
                                            onChange={(e) => setNumTickets(parseInt(e.target.value) || 1)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Jackpot Size (millions)</label>
                                        <input 
                                            type="number" 
                                            min="20" 
                                            max="2000" 
                                            value={jackpotAmount}
                                            onChange={(e) => setJackpotAmount(parseInt(e.target.value) || 100)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        />
                                    </div>
                                </div>

                                <div className="bg-white rounded-lg p-6 border">
                                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Simulation Results</h3>
                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div>
                                            <h4 className="font-medium text-gray-700 mb-3">Outcome Frequencies</h4>
                                            <div className="space-y-2">
                                                {Object.entries(monteCarloResults).filter(([key]) => 
                                                    ['jackpot', 'match5', 'match4Plus1', 'match4', 'match3Plus1', 'match3', 'match2Plus1', 'match1Plus1', 'match0Plus1', 'noWin'].includes(key)
                                                ).map(([outcome, count]) => (
                                                    <div key={outcome} className="flex justify-between items-center">
                                                        <span className="text-sm capitalize">{outcome.replace(/([A-Z])/g, ' $1').replace(/Plus/g, '+')}</span>
                                                        <div className="flex items-center gap-2">
                                                            <div className="w-20 bg-gray-200 rounded">
                                                                <div 
                                                                    className="bg-blue-500 h-2 rounded" 
                                                                    style={{width: `${(count / monteCarloRuns) * 100}%`}}
                                                                ></div>
                                                            </div>
                                                            <span className="text-sm font-mono w-12 text-right">{count}</span>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <h4 className="font-medium text-gray-700 mb-3">Financial Analysis</h4>
                                            <div className="space-y-3">
                                                <div className="flex justify-between">
                                                    <span className="text-sm text-gray-600">Total Spent:</span>
                                                    <span className="font-mono">${monteCarloResults.totalSpent?.toLocaleString()}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-sm text-gray-600">Total Won:</span>
                                                    <span className="font-mono">${monteCarloResults.totalWinnings?.toLocaleString()}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-sm text-gray-600">Net Loss:</span>
                                                    <span className="font-mono text-red-600">-${monteCarloResults.netLoss?.toLocaleString()}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-sm text-gray-600">Return Rate:</span>
                                                    <span className="font-mono">{monteCarloResults.expectedReturn}%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Tax Analysis Tab */}
                    {activeTab === 'taxes' && (
                        <div className="space-y-6">
                            <div className="bg-red-50 rounded-lg p-6">
                                <h2 className="text-2xl font-semibold text-red-800 mb-4 flex items-center gap-2">
                                    <DollarSign className="w-6 h-6" />
                                    Comprehensive Tax Analysis
                                </h2>
                                <p className="text-red-600 mb-6">Detailed federal, state, and local tax implications</p>
                                
                                <div className="grid md:grid-cols-3 gap-4 mb-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Jackpot Amount</label>
                                        <div className="relative">
                                            <span className="absolute left-3 top-2 text-gray-500">$</span>
                                            <input 
                                                type="number" 
                                                min="1" 
                                                max="2000" 
                                                value={jackpotAmount}
                                                onChange={(e) => setJackpotAmount(parseInt(e.target.value) || 100)}
                                                className="w-full pl-8 p-2 border border-gray-300 rounded"
                                            />
                                            <span className="absolute right-3 top-2 text-gray-500">million</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">State</label>
                                        <select 
                                            value={selectedState} 
                                            onChange={(e) => setSelectedState(e.target.value)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        >
                                            {Object.entries(stateTaxInfo).map(([code, info]) => (
                                                <option key={code} value={code}>{info.name} ({info.rate}%)</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Filing Status</label>
                                        <select 
                                            value={filingStatus} 
                                            onChange={(e) => setFilingStatus(e.target.value)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        >
                                            <option value="single">Single</option>
                                            <option value="married">Married Filing Jointly</option>
                                        </select>
                                    </div>
                                </div>

                                <div className="bg-white rounded-lg p-6 border">
                                    <h3 className="text-xl font-semibold text-gray-800 mb-6">Tax Breakdown</h3>
                                    <div className="space-y-3">
                                        <div className="flex justify-between py-2 border-b">
                                            <span className="text-gray-600">Gross Winnings:</span>
                                            <span className="font-mono text-lg">${taxAnalysis.grossWinnings?.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between py-2">
                                            <span className="text-gray-600">Federal Tax:</span>
                                            <span className="font-mono text-red-600">-${taxAnalysis.federalTax?.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between py-2">
                                            <span className="text-gray-600">State Tax:</span>
                                            <span className="font-mono text-red-600">-${taxAnalysis.stateTax?.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between py-2 border-t font-semibold">
                                            <span className="text-gray-800">Total Tax:</span>
                                            <span className="font-mono text-red-600">-${taxAnalysis.totalTax?.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between py-2 border-t font-bold text-lg">
                                            <span className="text-green-700">Net Payout:</span>
                                            <span className="font-mono text-green-700">${taxAnalysis.netPayout?.toLocaleString()}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Expected Value Tab */}
                    {activeTab === 'expected' && (
                        <div className="space-y-6">
                            <div className="bg-purple-50 rounded-lg p-6">
                                <h2 className="text-2xl font-semibold text-purple-800 mb-4 flex items-center gap-2">
                                    <BarChart3 className="w-6 h-6" />
                                    Expected Value Analysis
                                </h2>
                                <p className="text-purple-600 mb-6">Mathematical analysis of lottery investment returns</p>
                                
                                <div className="grid md:grid-cols-2 gap-4 mb-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Number of Tickets</label>
                                        <input 
                                            type="number" 
                                            min="1" 
                                            max="1000" 
                                            value={numTickets}
                                            onChange={(e) => setNumTickets(parseInt(e.target.value) || 1)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Jackpot Size (millions)</label>
                                        <input 
                                            type="number" 
                                            min="20" 
                                            max="2000" 
                                            value={jackpotAmount}
                                            onChange={(e) => setJackpotAmount(parseInt(e.target.value) || 100)}
                                            className="w-full p-2 border border-gray-300 rounded"
                                        />
                                    </div>
                                </div>

                                <div className="grid md:grid-cols-2 gap-6">
                                    <div className="bg-white rounded-lg p-6 border">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">Expected Value Calculation</h3>
                                        <div className="space-y-3">
                                            <div className="flex justify-between py-2 border-b">
                                                <span className="text-gray-600">Expected Winnings:</span>
                                                <span className="font-mono">${expectedValue.expectedWinnings?.toFixed(2)}</span>
                                            </div>
                                            <div className="flex justify-between py-2">
                                                <span className="text-gray-600">Total Cost:</span>
                                                <span className="font-mono text-red-600">${expectedValue.totalCost?.toLocaleString()}</span>
                                            </div>
                                            <div className="flex justify-between py-2 border-t font-semibold">
                                                <span className="text-gray-800">Expected Return:</span>
                                                <span className={`font-mono ${expectedValue.expectedReturn < 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                    ${expectedValue.expectedReturn?.toFixed(2)}
                                                </span>
                                            </div>
                                            <div className="flex justify-between py-2">
                                                <span className="text-gray-600">ROI:</span>
                                                <span className={`font-mono ${expectedValue.roi < 0 ? 'text-red-600' : 'text-green-600'}`}>
                                                    {expectedValue.roi}%
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-white rounded-lg p-6 border">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">Win Probability Analysis</h3>
                                        <div className="space-y-4">
                                            <div>
                                                <div className="flex justify-between mb-2">
                                                    <span className="text-sm text-gray-600">Probability of Any Win</span>
                                                    <span className="font-mono text-sm">{(expectedValue.probabilityTree?.atLeastOneWin * 100)?.toFixed(4)}%</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-2">
                                                    <div 
                                                        className="bg-green-500 h-2 rounded-full" 
                                                        style={{width: `${(expectedValue.probabilityTree?.atLeastOneWin * 100) || 0}%`}}
                                                    ></div>
                                                </div>
                                            </div>
                                            
                                            <div>
                                                <div className="flex justify-between mb-2">
                                                    <span className="text-sm text-gray-600">Probability of No Win</span>
                                                    <span className="font-mono text-sm">{(expectedValue.probabilityTree?.noWin * 100)?.toFixed(4)}%</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-2">
                                                    <div 
                                                        className="bg-red-500 h-2 rounded-full" 
                                                        style={{width: `${(expectedValue.probabilityTree?.noWin * 100) || 0}%`}}
                                                    ></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<AdvancedLotteryAnalysisSystem />, document.getElementById('root'));
    </script>
</body>
</html> <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Lottery Intelligence System</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;
        
        // Lucide React icons (simplified for standalone HTML)
        const Calculator = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>;
        const TrendingUp = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>;
        const Target = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" /></svg>;
        const Hash = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" /></svg>;
        const BarChart3 = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>;
        const DollarSign = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" /></svg>;
        const Brain = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>;

        const AdvancedLotteryAnalysisSystem = () => {
            const [selectedNumbers, setSelectedNumbers] = useState([]);
            const [powerball, setPowerball] = useState('');
            const [results, setResults] = useState({});
            const [activeTab, setActiveTab] = useState('calculator');
            const [jackpotAmount, setJackpotAmount] = useState(100);
            const [selectedState, setSelectedState] = useState('FL');
            const [filingStatus, setFilingStatus] = useState('single');
            const [numTickets, setNumTickets] = useState(1);
            const [monteCarloRuns, setMonteCarloRuns] = useState(1000);
            const [currentJackpot, setCurrentJackpot] = useState(null);
            const [nextDrawDate, setNextDrawDate] = useState('');
            const [lastUpdated, setLastUpdated] = useState(new Date().toISOString().split('T')[0]);
            const [isUpdating, setIsUpdating] = useState(false);
            const [updateStatus, setUpdateStatus] = useState('');
            const [historicalData, setHistoricalData] = useState([
                { date: '2025-05-10', numbers: [5, 20, 28, 39, 42], powerball: 13, jackpot: 82000000 },
                { date: '2025-04-30', numbers: [1, 2, 3, 57, 59], powerball: 9, jackpot: 75000000 },
                { date: '2025-04-28', numbers: [26, 43, 51, 56, 60], powerball: 24, jackpot: 65000000 },
                { date: '2025-04-26', numbers: [1, 12, 14, 18, 69], powerball: 2, jackpot: 55000000 },
                { date: '2025-04-23', numbers: [15, 44, 63, 66, 69], powerball: 20, jackpot: 45000000 }
            ]);

            // State tax information
            const stateTaxInfo = {
                'FL': { name: 'Florida', rate: 0, withholding: 0 },
                'CA': { name: 'California', rate: 13.3, withholding: 7.25 },
                'NY': { name: 'New York', rate: 10.9, withholding: 10.9, local: 3.876 },
                'TX': { name: 'Texas', rate: 0, withholding: 0 },
                'NJ': { name: 'New Jersey', rate: 10.75, withholding: 5.0 },
                'PA': { name: 'Pennsylvania', rate: 3.07, withholding: 3.07 },
                'OH': { name: 'Ohio', rate: 3.99, withholding: 4.0 },
                'MI': { name: 'Michigan', rate: 4.25, withholding: 4.25 },
                'IL': { name: 'Illinois', rate: 4.95, withholding: 4.95 },
                'GA': { name: 'Georgia', rate: 5.75, withholding: 6.0 }
            };

            // Real API implementation using serverless function
            const fetchLatestPowerballData = async () => {
                setIsUpdating(true);
                setUpdateStatus('Fetching live jackpot data...');
                
                try {
                    setUpdateStatus('Connecting to lottery data API...');
                    
                    // Call our serverless function that scrapes real lottery data
                    const response = await fetch('/api/powerball', {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`API request failed: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (!data.success || !data.jackpot) {
                        throw new Error(data.message || 'No jackpot data available');
                    }
                    
                    // We have real jackpot data!
                    const realJackpotData = {
                        amount: data.jackpot.amount,
                        cashValue: data.jackpot.cashValue,
                        source: data.source
                    };
                    
                    setCurrentJackpot(realJackpotData);
                    
                    // Set next drawing info
                    if (data.nextDrawing) {
                        setNextDrawDate(`${data.nextDrawing.date} @ ${data.nextDrawing.time}`);
                    }
                    
                    setUpdateStatus(`✅ Live data: ${data.jackpot.formatted} from ${data.source}`);
                    setLastUpdated(new Date().toISOString().split('T')[0]);
                    
                } catch (error) {
                    console.error('Failed to fetch real lottery data:', error);
                    setCurrentJackpot(null);
                    setNextDrawDate('');
                    setUpdateStatus("We can't see the live data at this time. Try again.");
                }
                
                setIsUpdating(false);
            };

            // Initialize with NO data - wait for real API only
            useEffect(() => {
                const initializeData = async () => {
                    setCurrentJackpot(null);
                    setNextDrawDate('');
                    setUpdateStatus('Loading live jackpot data...');
                    
                    await fetchLatestPowerballData();
                };
                
                initializeData();
            }, []);

            const runMonteCarloSimulation = useCallback((numRuns = 10000, ticketCount = 1) => {
                let outcomes = {
                    jackpot: 0, match5: 0, match4Plus1: 0, match4: 0, match3Plus1: 0,
                    match3: 0, match2Plus1: 0, match1Plus1: 0, match0Plus1: 0, noWin: 0,
                    totalSpent: ticketCount * 2 * numRuns, totalWinnings: 0
                };

                const prizeAmounts = {
                    jackpot: jackpotAmount * 1000000, match5: 1000000, match4Plus1: 50000,
                    match4: 100, match3Plus1: 100, match3: 7, match2Plus1: 7, match1Plus1: 4, match0Plus1: 4
                };

                for (let run = 0; run < numRuns; run++) {
                    let runWinnings = 0;
                    
                    for (let ticket = 0; ticket < ticketCount; ticket++) {
                        const ticketNumbers = [], winningNumbers = [];
                        while (ticketNumbers.length < 5) {
                            const num = Math.floor(Math.random() * 69) + 1;
                            if (!ticketNumbers.includes(num)) ticketNumbers.push(num);
                        }
                        while (winningNumbers.length < 5) {
                            const num = Math.floor(Math.random() * 69) + 1;
                            if (!winningNumbers.includes(num)) winningNumbers.push(num);
                        }
                        
                        const ticketPB = Math.floor(Math.random() * 26) + 1;
                        const winningPB = Math.floor(Math.random() * 26) + 1;
                        const mainMatches = ticketNumbers.filter(num => winningNumbers.includes(num)).length;
                        const pbMatch = ticketPB === winningPB;

                        if (mainMatches === 5 && pbMatch) { outcomes.jackpot++; runWinnings += prizeAmounts.jackpot; }
                        else if (mainMatches === 5) { outcomes.match5++; runWinnings += prizeAmounts.match5; }
                        else if (mainMatches === 4 && pbMatch) { outcomes.match4Plus1++; runWinnings += prizeAmounts.match4Plus1; }
                        else if (mainMatches === 4) { outcomes.match4++; runWinnings += prizeAmounts.match4; }
                        else if (mainMatches === 3 && pbMatch) { outcomes.match3Plus1++; runWinnings += prizeAmounts.match3Plus1; }
                        else if (mainMatches === 3) { outcomes.match3++; runWinnings += prizeAmounts.match3; }
                        else if (mainMatches === 2 && pbMatch) { outcomes.match2Plus1++; runWinnings += prizeAmounts.match2Plus1; }
                        else if (mainMatches === 1 && pbMatch) { outcomes.match1Plus1++; runWinnings += prizeAmounts.match1Plus1; }
                        else if (pbMatch) { outcomes.match0Plus1++; runWinnings += prizeAmounts.match0Plus1; }
                        else { outcomes.noWin++; }
                    }
                    
                    outcomes.totalWinnings += runWinnings;
                }

                outcomes.expectedReturn = (outcomes.totalWinnings / outcomes.totalSpent * 100).toFixed(2);
                outcomes.netLoss = outcomes.totalSpent - outcomes.totalWinnings;
                
                return outcomes;
            }, [jackpotAmount]);

            const performRegressionAnalysis = useMemo(() => {
                const numberFreq = {}, powerballFreq = {};
                
                for (let i = 1; i <= 69; i++) numberFreq[i] = [];
                for (let i = 1; i <= 26; i++) powerballFreq[i] = [];
                
                historicalData.forEach((draw, index) => {
                    draw.numbers.forEach(num => { numberFreq[num].push(index); });
                    powerballFreq[draw.powerball].push(index);
                });

                const trends = {};
                Object.entries(numberFreq).forEach(([num, appearances]) => {
                    if (appearances.length > 0) {
                        const avgPosition = appearances.reduce((a, b) => a + b, 0) / appearances.length;
                        const recentBias = appearances.filter(pos => pos < historicalData.length / 3).length / appearances.length;
                        trends[num] = {
                            frequency: appearances.length,
                            avgPosition,
                            recentBias,
                            trend: recentBias > 0.6 ? 'increasing' : recentBias < 0.4 ? 'decreasing' : 'stable'
                        };
                    }
                });

                return { trends, numberFreq, powerballFreq };
            }, [historicalData]);

            const optimizeNumberSelection = useMemo(() => {
                const regression = performRegressionAnalysis;
                
                const generateOptimalSet = () => {
                    const candidates = [];
                    
                    for (let num = 1; num <= 69; num++) {
                        const trend = regression.trends[num] || { frequency: 0, recentBias: 0.5 };
                        const score = trend.frequency * 0.5 + (1 - trend.recentBias) * 0.5;
                        candidates.push({ number: num, score });
                    }
                    
                    candidates.sort((a, b) => b.score - a.score);
                    
                    const selected = [];
                    const ranges = [[1, 14], [15, 28], [29, 42], [43, 56], [57, 69]];
                    
                    ranges.forEach(([min, max]) => {
                        const rangeCandidate = candidates.find(c => 
                            c.number >= min && c.number <= max && !selected.includes(c.number)
                        );
                        if (rangeCandidate) selected.push(rangeCandidate.number);
                    });
                    
                    return selected.slice(0, 5).sort((a, b) => a - b);
                };

                return {
                    optimal: generateOptimalSet(),
                    contrarian: [7, 15, 23, 31, 47],
                    regression: regression
                };
            }, [historicalData, performRegressionAnalysis]);

            const calculateTaxes = useCallback((winnings, state = 'FL', filing = 'single') => {
                const federalBrackets2025 = {
                    single: [
                        { min: 0, max: 11925, rate: 0.10 },
                        { min: 11925, max: 48475, rate: 0.12 },
                        { min: 48475, max: 103350, rate: 0.22 },
                        { min: 103350, max: 197300, rate: 0.24 },
                        { min: 197300, max: 609350, rate: 0.32 },
                        { min: 609350, max: Infinity, rate: 0.37 }
                    ],
                    married: [
                        { min: 0, max: 23850, rate: 0.10 },
                        { min: 23850, max: 96950, rate: 0.12 },
                        { min: 96950, max: 206700, rate: 0.22 },
                        { min: 206700, max: 394600, rate: 0.24 },
                        { min: 394600, max: 731200, rate: 0.32 },
                        { min: 731200, max: Infinity, rate: 0.37 }
                    ]
                };

                let federalTax = 0, remainingIncome = winnings;
                const brackets = federalBrackets2025[filing] || federalBrackets2025.single;

                brackets.forEach(bracket => {
                    if (remainingIncome > 0) {
                        const taxableInBracket = Math.min(remainingIncome, bracket.max - bracket.min);
                        federalTax += taxableInBracket * bracket.rate;
                        remainingIncome -= taxableInBracket;
                    }
                });

                const stateInfo = stateTaxInfo[state] || stateTaxInfo.FL;
                const stateTax = winnings * (stateInfo.rate / 100);
                const localTax = winnings * ((stateInfo.local || 0) / 100);
                const federalWithholding = winnings * 0.24;
                const stateWithholding = winnings * ((stateInfo.withholding || 0) / 100);
                const totalTax = federalTax + stateTax + localTax;
                const totalWithholding = federalWithholding + stateWithholding;
                const netPayout = winnings - totalTax;
                
                return {
                    grossWinnings: winnings, federalTax, stateTax, localTax, totalTax,
                    federalWithholding, stateWithholding, totalWithholding, netPayout,
                    effectiveRate: (totalTax / winnings * 100).toFixed(2)
                };
            }, []);

            const calculateExpectedValue = useCallback((ticketCount = 1, jackpot = 100000000) => {
                const prizes = [
                    { match: 'Jackpot (5+1)', odds: 1/292201338, prize: jackpot },
                    { match: '5+0', odds: 1/11688053.52, prize: 1000000 },
                    { match: '4+1', odds: 1/913129.18, prize: 50000 },
                    { match: '4+0', odds: 1/36525.17, prize: 100 },
                    { match: '3+1', odds: 1/14494.11, prize: 100 },
                    { match: '3+0', odds: 1/579.76, prize: 7 },
                    { match: '2+1', odds: 1/701.33, prize: 7 },
                    { match: '1+1', odds: 1/91.98, prize: 4 },
                    { match: '0+1', odds: 1/38.32, prize: 4 }
                ];

                let expectedWinnings = 0;
                prizes.forEach(prize => {
                    expectedWinnings += prize.odds * prize.prize * ticketCount;
                });

                const totalCost = ticketCount * 2;
                const expectedReturn = expectedWinnings - totalCost;
                const roi = (expectedReturn / totalCost * 100).toFixed(2);

                const probabilityTree = {
                    noWin: Math.pow(1 - (1/38.32), ticketCount),
                    atLeastOneWin: 1 - Math.pow(1 - (1/38.32), ticketCount),
                    jackpotOdds: 1 - Math.pow(1 - (1/292201338), ticketCount)
                };

                return {
                    expectedWinnings, totalCost, expectedReturn, roi, probabilityTree,
                    breakEvenJackpot: (totalCost - (expectedWinnings - jackpot * (1/292201338))) / (1/292201338)
                };
            }, []);

            const toggleNumber = (num) => {
                if (selectedNumbers.includes(num)) {
                    setSelectedNumbers(selectedNumbers.filter(n => n !== num));
                } else if (selectedNumbers.length < 5) {
                    setSelectedNumbers([...selectedNumbers, num].sort((a, b) => a - b));
                }
            };

            // Memoized calculations
            const monteCarloResults = useMemo(() => 
                runMonteCarloSimulation(monteCarloRuns, numTickets), 
                [runMonteCarloSimulation, monteCarloRuns, numTickets]
            );
            
            const taxAnalysis = useMemo(() => 
                calculateTaxes(jackpotAmount * 1000000, selectedState, filingStatus), 
                [calculateTaxes, jackpotAmount, selectedState, filingStatus]
            );
            
            const expectedValue = useMemo(() => 
                calculateExpectedValue(numTickets, jackpotAmount * 1000000), 
                [calculateExpectedValue, numTickets, jackpotAmount]
            );

            return (
                <div className="max-w-7xl mx-auto p-6 bg-white">
                    {/* Current Jackpot Display - Persistent Module */}
                    <div className="sticky top-0 z-50 mb-6 bg-gradient-to-r from-purple-600 via-blue-600 to-green-600 rounded-xl p-6 shadow-lg border-2 border-white">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <div className="bg-white/20 backdrop-blur-sm rounded-full p-3">
                                    <DollarSign className="w-8 h-8 text-white" />
                                </div>
                                <div>
                                    <div className="text-white/80 text-sm font-medium">Current Powerball Jackpot</div>
                                    <div className="text-white text-3xl font-bold">
                                        {currentJackpot ? (
                                            `$${(currentJackpot.amount / 1000000).toFixed(0)}M`
                                        ) : (
                                            <span className="text-white/70 text-xl">Loading...</span>
                                        )}
                                    </div>
                                    <div className="text-white/70 text-xs">
                                        {currentJackpot ? (
                                            <span>Source: Official Powerball API • </span>
                                        ) : (
                                            <span>Connecting to official data • </span>
                                        )}
                                        Next Drawing: {nextDrawDate || 'TBD'}
                                    </div>
                                </div>
                            </div>
                            
                            <div className="text-right">
                                <div className="bg-white/10 backdrop-blur-sm rounded-lg p-3 mb-2">
                                    <div className="text-white/80 text-xs">Cash Value (Est.)</div>
                                    <div className="text-white text-xl font-bold">
                                        {currentJackpot ? (
                                            `$${((currentJackpot.cashValue || currentJackpot.amount * 0.6) / 1000000).toFixed(0)}M`
                                        ) : (
                                            <span className="text-white/70">---</span>
                                        )}
                                    </div>
                                </div>
                                <div className="bg-white/10 backdrop-blur-sm rounded-lg p-3">
                                    <div className="text-white/80 text-xs">After Taxes (Est.)</div>
                                    <div className="text-white text-lg font-bold">
                                        {currentJackpot ? (
                                            `$${(((currentJackpot.cashValue || currentJackpot.amount * 0.6) * 0.58) / 1000000).toFixed(0)}M`
                                        ) : (
                                            <span className="text-white/70">---</span>
                                        )}
                                    </div>
                                </div>
                            </div>
                            
                            <div className="text-center">
                                <div className="bg-white/20 backdrop-blur-sm rounded-lg p-4">
                                    <div className="text-white text-sm mb-1">Odds of Winning</div>
                                    <div className="text-white text-lg font-mono">1 : 292,201,338</div>
                                    <div className="text-white/70 text-xs mt-1">
                                        {currentJackpot ? (
                                            `${(() => {
                                                const expectedValue = (currentJackpot.amount / 292201338 + 0.32) - 2;
                                                return expectedValue > 0 ? `+$${expectedValue.toFixed(2)}` : `-$${Math.abs(expectedValue).toFixed(2)}`;
                                            })()} Expected Value`
                                        ) : (
                                            'Expected Value: ---'
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Quick Stats Bar */}
                        <div className="mt-4 flex items-center justify-between bg-white/10 backdrop-blur-sm rounded-lg p-3">
                            <div className="flex items-center gap-6 text-white/80 text-sm">
                                <div className="flex items-center gap-2">
                                    <div className={`w-2 h-2 rounded-full ${
                                        currentJackpot ? 'bg-green-400 animate-pulse' : 'bg-orange-400'
                                    }`}></div>
                                    <span>
                                        {currentJackpot ? 'Live Data Connected' : 'Connecting to APIs...'}
                                    </span>
                                </div>
                                <div>Ticket Price: $2.00</div>
                                <div>Power Play: +$1.00</div>
                                <div>Drawings: Mon, Wed, Sat @ 10:59 PM ET</div>
                            </div>
                            
                            <div className="flex items-center gap-2">
                                {currentJackpot && (() => {
                                    const breakEvenPoint = 584000000;
                                    const isPositiveEV = currentJackpot.amount > breakEvenPoint;
                                    
                                    return (
                                        <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                                            isPositiveEV 
                                                ? 'bg-green-500 text-white' 
                                                : 'bg-yellow-500 text-black'
                                        }`}>
                                            {isPositiveEV ? '✓ Positive EV' : '⚠ Negative EV'}
                                        </div>
                                    );
                                })()}
                                
                                <button
                                    onClick={fetchLatestPowerballData}
                                    disabled={isUpdating}
                                    className={`px-3 py-1 rounded-full text-xs font-medium transition-colors ${
                                        isUpdating 
                                            ? 'bg-white/20 text-white/50 cursor-not-allowed' 
                                            : 'bg-white/20 text-white hover:bg-white/30'
                                    }`}
                                >
                                    {isUpdating ? '⟳' : '🔄'} Update
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Header */}
                    <div className="mb-8">
                        <h1 className="text-4xl font-bold text-gray-800 mb-2 flex items-center gap-3">
                            <Brain className="text-purple-600" />
                            Advanced Lottery Intelligence System
                        </h1>
                        <div className="flex items-center justify-between">
                            <p className="text-gray-600">Sophisticated statistical analysis, tax modeling, and optimization algorithms</p>
                            <div className="flex items-center gap-4">
                                <div className="text-sm text-gray-500">
                                    Last updated: {lastUpdated}
                                </div>
                                <button
                                    onClick={fetchLatestPowerballData}
                                    disabled={isUpdating}
                                    className={`px-4 py-2 rounded-